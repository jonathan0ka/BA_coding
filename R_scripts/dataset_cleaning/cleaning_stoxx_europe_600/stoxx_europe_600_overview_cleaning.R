
####################################################### unique names data set
unique_names_data <- read.csv("/Users/jonathanzeh/Library/CloudStorage/OneDrive-Personal/RStudio/BA_Thesis/merged_data_sets/stoxx_europe_600_overview_raw.csv")
colnames(unique_names_data) <- c("ticker", "name", "sector", "weight", "region", "stock_exchange", "date", "consistent_name")
unique_names_data$name[unique_names_data$name == ""] <- NA
unique_names_data <- na.omit(unique_names_data, subset = "name")
#######################################################

# Define consistent names for each group
name_mapping <- list(
  "ADEVINTA" = c("ADEVINTA", "ADEVINTA CLASS A"),
  "AKZO NOBEL NV" = c("AKZO NOBEL NV", "AKZONOBEL"),
  "ALSTOM" = c("ALSTOM SA", "ALSTOM", "ALSTOM RIGHTS SA"),
  "ALSTRIA OFFICE REIT AG" = c("ALSTRIA OFFICE REIT AG", "ALSTRIA", "ALSTRIA ACCEPTANCE SHARES"),
  "AMADEUS IT GROUP" = c("AMADEUS IT GROUP SA", "AMADEUS"),
  "ARCELORMITTAL" = c("ARCELORMITTAL NPV", "ARCELORMITTAL SA", "ARCELORMITTAL RIGHTS SA"),
  "ASML" = c("ASML HOLDING N.V.", "ASML HOLDING NV"),
  "ASSICURAZIONI GENERALI" = c("ASSICURAZIONI GENERALI", 
                               "GENERALI ASSICURAZIONI"),
  "ASTRAZENECA" = c("ASTRAZENECA PLC", "ASTRAZENECA"),
  "ATLAS COPCO" = c("ATLAS COPCO AB", "ATLAS COPCO CLASS A", "ATLAS COPCO", "ATLAS COPCO A",
                    "ATLAS COPCO AB-A SHS", "ATLAS COPCO A ORD", "ATLAS COPCO REDEMPTION SHARES CLAS",
                    "ATLAS COPCO A REDEMPTION SHARES"),
  "BANCO BILBAO VIZCAYA ARGENTARIA" = c("BANCO BILBAO VIZCAYA ARGENTARIA SA",
                                        "BANCO BILBAO VIZCAYA ARGENTARIA RI"),
  "BASF" = c("BASF SE", "BASF N"),
  "BAYER AG" = c("BAYER N", "BAYER RIGHTS AG", "BAYER SCHERING PHARMA AG"),
  "BEIERSDORF" = c("BEIERSDORF AG", "BEIERSDORF"),
  "BNP PARIBAS SA" = c("BNP PARIBAS SA", "BNP PARIBAS"),
  "BP" = c("BP PLC", "BP"),
  "CARREFOUR" = c("CARREFOUR SA", "CARREFOUR"),
  "CREDIT AGRICOLE" = c("CREDIT AGRICOLE SA", "CREDIT AGRICOLE"),
  "CRH" = c("CRH PLC", "CRH PUBLIC LIMITED PLC", "CRH"),
  "DANONE" = c("DANONE SA", "DANONE"),
  "DEUTSCHE BANK" = c("DEUTSCHE BANK AG", "DEUTSCHE BANK"),
  "DEUTSCHE TELEKOM" = c("DEUTSCHE TELEKOM AG", "DEUTSCHE TELEKOM N AG"),
  "DEUTSCHE BOERSE AG" = c("DEUTSCHE BOERSE AG-NEW"),
  "DIAGEO" = c("DIAGEO PLC", "DIAGEO"),
  "ENEL" = c("ENEL SPA", "ENEL", "ENEL GREEN POWER"),
  "ENI" = c("ENI SPA", "ENI"),
  "ESSILORLUXOTTICA" = c("ESSILOR INTERNATIONAL SA", "ESSILORLUXOTTICA SA"),
  "FERROVIAL" = c("FERROVIAL SA", "FERROVIAL"),
  "GENERALI" = c("ASSICURAZIONI GENERALI", "GENERALI ASSICURAZIONI"),
  "GLENCORE" = c("GLENCORE PLC", "GLENCORE"),
  "HEINEKEN" = c("HEINEKEN NV", "HEINEKEN"),
  "HSBC" = c("HSBC HOLDINGS PLC", "HSBC"),
  "IBERDROLA" = c("IBERDROLA SA", "IBERDROL"),
  "ADEVINTA" = c("ADEVINTA", "ADEVINTA CLASS A"),
  "ARCELORMITTAL" = c("ARCELORMITTAL NPV", "ARCELORMITTAL SA"),
  "ASML" = c("ASML HOLDING N.V.", "ASML HOLDING NV"),
  "ALTICE EUROPE NV" = c("ALTICE CLASS A NV", "ALTICE CLASS B NV", 
               "ALTICE USA INC CLASS A", "ALTICE CLASS B NV WHEN ISSUED",
               "ALTICE CLASS A NV", "ALTICE SA SA"),
  "ATLAS COPCO" = c("ATLAS COPCO AB", "ATLAS COPCO CLASS A"),
  "CRH" = c("CRH PLC", "CRH PUBLIC LIMITED PLC"),
  "INDITEX" = c("INDUSTRIA DE DISENO TEXTIL INDITEX", "INDITEX SA"),
  "INTESA SANPAOLO" = c("INTESA SANPAOLO", "INTESA SANPAOLO SPA"),
  "LVMH" = c("LVMH", "LVMH MOET HENNESSY LOUIS VUITTON SE", "Morgan Stanley Certificate on LVMH",
             "LVMH MOET HENNESSY LOUIS VUITTON S", "LVMH MOET HENNESSY LOUIS VUITTON O"),
  "MERCK" = c("MERCK", "MERCK KGAA"),
  "MICHELIN" = c("MICHELIN", "COMPAGNIE GENERALE DES ETABLISSEMENTS MICHELIN"),
  "NOKIA" = c("NOKIA", "NOKIA OYJ"),
  "ORANGE" = c("ORANGE", "ORANGE SA"),
  "SAINT-GOBAIN" = c("SAINT-GOBAIN", "COMPAGNIE DE SAINT GOBAIN SA"),
  "SANOFI" = c("SANOFI", "SANOFI SA"),
  "SAP" = c("SAP", "SAP SE"),
  "SOCIETE GENERALE" = c("SOCIETE GENERALE", "SOCIETE GENERALE SA"),
  "TELEFONICA" = c("TELEFONICA SA", "TELEFONICA DEUTSCHLAND HOLDING AG"),
  "TESCO" = c("TESCO", "TESCO PLC"),
  "UNICREDIT" = c("UNICREDIT", "UNICREDIT SPA"),
  "UNILEVER" = c("UNILEVER NV", "UNILEVER PLC", "UNILEVER DRC NV", 
                 "UNILEVER DUTCH CERTIFICATES NV"),
  "VIVENDI" = c("VIVENDI", "VIVENDI SA"),
  "VODAFONE GROUP PLC" = c("VODAFONE GROUP PLC", "VODAFONE PLC"),
  "VOLKSWAGEN" = c("VOLKSWAGEN AG", "VOLKSWAGEN NON-VOTING PREF AG", "VOLKSWAGEN AG (PFD NON-VTG)"),
  "VOLVO" = c("VOLVO AB", "VOLVO CAR CLASS B", "VOLVO CLASS B"),
  "ZURICH INSURANCE" = c("ZURICH INSURANCE GROUP AG", "ZURICH INSURANCE GROUP"),
  "ZALANDO" = c("ZALANDO SE", "ZALANDO AG"),
  "STELLANTIS" = c("STELLANTIS NV", "STELLANTIS"),
  "MONDI" = c("MONDI PLC", "MONDI LTD"),
  "SCHNEIDER ELECTRIC" = c("SCHNEIDER ELECTRIC SE", "SCHNEIDER ELECTRIC SA"),
  "RECKITT BENCKISER" = c("RECKITT BENCKISER GROUP PLC", 
                          "RECKITT BENCKISER PLC"),
  "RANDSTAD" = c("RANDSTAD NV", "RANDSTAD HOLDING NV"),
  "KBC" = c("KBC GROEP NV", "KBC ANCORA"),
  "ING" = c("ING GROEP NV", "ING BANK NV"),
  "HEINEKEN" = c("HEINEKEN NV", "HEINEKEN HOLDING NV"),
  "G4S" = c("G4S PLC", "G4S LTD"),
  "FRESNILLO" = c("FRESNILLO PLC", "FRESNILLO LTD"),
  "EXPERIAN" = c("EXPERIAN PLC", "EXPERIAN LTD"),
  "DCC" = c("DCC PLC", "DCC LTD"),
  "COCA-COLA HBC" = c("COCA COLA HBC AG", 
                      "COCA-COLA HELLENIC BOTTLING COMPANY SA"),
  "ROYAL DUTCH SHELL PLC" = c("ROYAL DUTCH SHELL PLC", "SHELL PLC", "ROYAL DUTCH SHELL PLC CLASS A"),
  "BP" = c("BP PLC", "BP P.L.C."),
  "GLAXOSMITHKLINE" = c("GLAXOSMITHKLINE PLC", "GSK PLC"),
  "ROYAL BANK OF SCOTLAND" = c("ROYAL BANK OF SCOTLAND GROUP PLC", "RBS PLC"),
  "LLOYDS BANKING" = c("LLOYDS BANKING GROUP PLC", "LLOYDS TSB GROUP PLC"),
  "HSBC" = c("HSBC HOLDINGS PLC", "HSBC PLC"),
  "BT GROUP" = c("BT GROUP PLC", "BRITISH TELECOM PLC"),
  "VODAFONE GROUP" = c("VODAFONE GROUP PLC", "VODAFONE PLC"),
  "TESCO" = c("TESCO PLC", "TESCO STORES LTD"),
  "SAINSBURY" = c("SAINSBURY (J) PLC", "J SAINSBURY PLC"),
  "ASTRAZENECA" = c("ASTRAZENECA PLC", "ASTRAZENECA LP"),
  "DIAGEO" = c("DIAGEO PLC", "DIAGEO LTD"),
  "IMPERIAL BRANDS" = c("IMPERIAL BRANDS PLC", "IMPERIAL TOBACCO GROUP PLC"),
  "RECKITT BENCKISER GROUP" = c("RECKITT BENCKISER GROUP PLC", 
                                "RECKITT BENCKISER PLC"),
  "COMPASS GROUP" = c("COMPASS GROUP PLC", "COMPASS GROUP LTD"),
  "ASSOCIATED BRITISH FOODS" = c("ASSOCIATED BRITISH FOODS PLC", "ABF PLC"),
  "BHP GROUP PLC" = c("BHP GROUP PLC", "BHP BILLITON PLC", "BHP BILLITON PLC (GB)"),
  "RIO TINTO" = c("RIO TINTO PLC", "RIO TINTO LTD"),
  "ANGLO AMERICAN" = c("ANGLO AMERICAN PLC", "ANGLO AMERICAN LTD"),
  "BP" = c("BP PLC", "BP P.L.C."),
  "RIO TINTO" = c("RIO TINTO PLC", "RIO TINTO LTD"),
  "GLENCORE" = c("GLENCORE PLC", "GLENCORE XSTRATA PLC"),
  "VODAFONE" = c("VODAFONE GROUP PLC", "VODAFONE PLC"),
  "TESCO" = c("TESCO PLC", "TESCO STORES LTD"),
  "SAINSBURY" = c("J SAINSBURY PLC", "SAINSBURY (J) PLC"),
  "HSBC" = c("HSBC HOLDINGS PLC", "HSBC PLC"),
  "LLOYDS BANKING" = c("LLOYDS BANKING GROUP PLC", "LLOYDS BANK PLC"),
  "BT GROUP" = c("BT GROUP PLC", "BRITISH TELECOMMUNICATIONS PLC"),
  "DIAGEO" = c("DIAGEO PLC", "DIAGEO LTD"),
  "UNILEVER" = c("UNILEVER PLC", "UNILEVER NV", "UNILEVER N.V."),
  "RECKITT BENCKISER" = c("RECKITT BENCKISER GROUP PLC", 
                          "RECKITT BENCKISER PLC"),
  "ASTRAZENECA" = c("ASTRAZENECA PLC", "ASTRAZENECA LTD"),
  "GLAXOSMITHKLINE" = c("GLAXOSMITHKLINE PLC", "GSK PLC"),
  "AA PLC" = c("AA PLC-SUB SHS RTS"),
  "ABERTIS INFRAESTRUCTURAS SA" = c("ABERTIS INFRAESTRUCTURAS S.A. RFD"),
  "ALK-ABELLO CLASS B" =c("ALK ABELLO A/S"),
  "ATLAS COPCO" = c("ATLAS COPCO A"),
  "ATRIUM EUROPEAN REAL ESTATE LTD" = c("ATRIUM EUROPEAN REAL ESTATE"),
  "AXEL SPRINGER V" = c("AXEL SPRINGER"),
  "BANK OF IRELAND GROUP PLC" = c("BANK OF IRELAND STK EUR0.64"),
  "BE SEMICONDUCTOR INDUSTRIES NV" = c("BE SEMICONDUCT NV"),
  "BEIJER REF CLASS B" = c("BEIJER REF PAID SUBSCRIPTION SHARE"),
  "BKW N AG" = c("BKW FMB ENERGIE AG", "BKW N AG"),
  "BOLIDEN" = c("BOLIDEN REDEMPTION SHARES", "BOLIDEN LTD -COM"),
  "BOOKER GROUP PLC" = c("BOOKER GROUP B SHARES"),
  "BRIT INSURANCE HOLDINGS" = c("BRIT INSURANCE HOLDINGS PLC"),
  "BRITISH AMERICAN TOBACCO" = c("BRITISH AMERICAN TOBACCO PLC"),
  "BWIN.PARTY DIGITAL ENTERTAINMENT P" = c("BWIN INTERACTIVE ENTERTAINMENT"),
  "CABLE & WIRELESS COMMUNICATIONS PL"= c("CABLE AND WIRELESS WORLDWIDE PLC"),
  "CADBURY PLC" = c("CADBURY SCHWEPPES PLC"),
  "CASTELLUM AB NVP" = c("CASTELLUM PAID SUBSCRIPTION SHARES"),
  "CHEMRING GROUP PLC" = c("CHEMRING GROUP"),
  "COCA-COLA HELLENIC BOTTLING CO. S." = c("COCA-COLA HELLENIC BOTTLING"),
  "COLOPLAST B" = c("COLOPLAST A/S"),
  "CORBION NV" = c("CORBION NV NV"),
  "DERECHOS DE ACS,ACTIVIDADES DE CON" = c("DERECHOS ACS ACTIVIDADES DE CONSTR"),
  "DEUTSCHE ANNINGTON IMMOBILIEN" = c("DEUTSCHE ANNINGTON IMMOBILIEN RIGH"),
  "DEUTSCHE WOHNEN" = c("DEUTSCHE WOHNEN E AG"),
  "DEXIA SA" = c("DEXIA S.A."),
  "DIXONS CARPHONE PLC" = c("DIXONS CARPHONE LTD"),
  "DNB BANK" = c("DNB"),
  "ELECTROLUX CLASS B" = c("ELECTROLUX PROFESSIONAL CLASS B", "ELECTROLUX REDEMPTION SHARES CLASS"),
  "EPIROC CLASS A" = c("EPIROC REDEMPTION SHARES CLASS A"),
  "ESSILORLUXOTTICA SA" = c("ESSILOR INTERNATIONAL COMPAGNIE GE", "ESSILOR INTERNATIONAL COMPAGNIE GE",
                            "ESSILORLUXOTTICA SA"),
  "EURAZEO" = c("EURAZEO-RTS"),
  "FERGUSON PLC" = c("FERGUSON"),
  "ROLLS-ROYCE HOLDINGS PLC" = c("ROLLS-ROYCE PREF C SHARE", "ROLLS-ROYCE HOLDINGS PREF PLC",
                                 "ROLLS-ROYCE HOLDINGS NIL PAID RIGH",
                                 "ROLLS-ROYCE HOLDINGS-ENTITL",
                                 "ROLLS ROYCE HLDGS C SHS ENTITLEMEN", 
                                 "ROLLS-ROYCE HOLDINGS PLC CL -C- TE",
                                 "ROLLS-ROYCE HOLDINGS PLC CL C",
                                 "ROLLS ROYCE PREF C SHARES"),
  "FIAT SPA" = c("FIAT INDUSTRIAL S.P.A."),
  "FRESENIUS SE AND CO KGAA" = c("FRESENIUS SE NON-VTG PRF"),
  "GETINGE B" = c( "GETINGE AB"),
  "HEXAGON CLASS B" = c("HEXAGON AB", "HEXAGON AB RTS"),
  "HENNES & MAURITZ" = c("HENNES & MAURITZ CLASS B"),
  "INNOGY" = c("INNOGY Z VERK"),
  "INTERNATIONAL AIRLINES GROUP SA" = c("INTERNATIONAL CONSOLIDATED AIRLINE"),
  "JACKSON FINANCIAL INC CLASS A" = c("JACKSON FINANCIAL INC", "JACKSON FINANCIAL INC CLASS A WHEN"),
  "JUST EAT TAKEAWAY.COM NV" = c("JUST EAT PLC"),
  "KESKO CLASS B" = c("KESKO OYJ"),
  "KINNEVIK CLASS B" = c("KINNEVIK REDEMPTION SHARES CLASS B"),
  "KONINKLIJKE AHOLD DELHAIZE NV" = c("KONINKLIJKE AHOLD NV"),
  "LADBROKES CORAL GROUP PLC" = c("LADBROKES PLC"),
  "LONDON STOCK EXCHANGE GROUP PLC" = c("LONDON STOCK EXCHANGE GROUP RTS PL"),
  "LUNDIN ENERGY" = c("LUNDIN PETROLEUM"),
  "MARKS AND SPENCER GROUP PLC" = c("MARKS AND SPENCER GROUP NILL PAID", "MARKS AND SPENCER GROUP FULL PAID"),
  "MERCEDES-BENZ GROUP N AG" = c("DAIMLER AG"),
  "METSO CORPORATION" = c("METSO"),
  "MILLICOM INTERNATIONAL CELLULAR SD" = c("MILLICOM INTERNATIONAL CELLULAR PA"),
  "NESTE" = c("NESTE OIL OYJ"),
  "NOVOZYMES B" = c("NOVOZYMES A/S"),
  "ORION CLASS B" = c("ORION OYJ"),
  "ORKLA" = c("ORKLA ASA"),
  "PORSCHE AUTOMOBIL HOLDING PREF" = c("PORSCHE AG"),
  "RELX PLC" = c("RELX NV"),
  "SAAB B" = c("SAAB AB SER B NPV"),
  "SAMPO" = c("SAMPO OYJ"),
  "SCOR" = c("SCOR SA"),
  "SECTRA AB" = c("SECTRA CLASS B"),
  "SECURITAS B" = c("SECURITAS CLASS B", "SECURITAS AB RIGHTS", "SECURITAS SUBSCRIPTION RIGHTS CLAS"),
  "SKF B" = c("SKF AB"),
  "SMITH AND NEPHEW PLC" = c("SMITH & NEPHEW PLC"),
  "SSAB CLASS B" = c("SSAB A"),
  "STANDARD LIFE ABERDEEN PLC" = c("STANDARD LIFE PLC"),
  "SUNRISE COMMUNICATIONS GROUP AG" = c("SUNRISE N . LINIE AG"),
  "SWISS RE AG" = c("SWISS REINSURANCE COMPANY LTD."),
  "TECHNICOLOR SA" = c("TECHNICOLOR NR"),
  "TECHNIP ENERGIES NV" = c("TECHNIP SA"),
  "TELE2 B" = c("TELE2 AB", "TELE2 AB REDEMPTION SHARES"),
  "TELEFONICA SA" = c("TELEFONICA SA - INTERIM SHARES", "TELEFONICA MOVILES SA", "TELEFONICA RIGHTS SA"),
  "TUI N AG" = c("TUI E AG", "TUI RIGHTS AG", "TUI AG RIGHTS", "TUI AG (NON RANKING FOR DIVIDEND)",
                 "TUI TRAVEL LTD", "TUI AG", "TUI E AG", "TUI AG", "TUI E AG", "TUI TRAVEL LTD"),
  "UBS GROUP AG" = c("UBS AG", "UBS N LINIE AG"),
  "UNIVERSAL MUSIC GROUP NV" = c("UNIVERSAL MUSIC GROUP"),
  "AVEVA GROUP PLC" = c("AVEVA GROUP FULLY PAID RIGHTS PLC", "AVEVA GROUP NIL PAID RIGHTS PLC"),
  
  "BARCLAYS PLC" = c("BARCLAYS FULLY PAID RIGHTS PLC", "BARCLAYS PLC", "BARCLAYS BANK PLC"),
  "BEIJER REF CLASS B" = c("BEIJER REF PAID SUBSCRIPTION SHARE"),
  "COBHAM PLC" = c("COBHAM RIGHTS PLC FULLY PAID", "COBHAM RIGHTS PLC"),
  "MARKS AND SPENCER GROUP PLC" = c("MARKS AND SPENCER GROUP FULL PAID"),
  "RSA INSURANCE GROUP LTD" = c("RSA INSURANCE GROUP FULLY PAID RIG", "RSA INSURANCE GROUP NIL PAID RIGHT"),
  "SMITH (DS) PLC" = c("SMITH (DS) RIGHTS FULLY PAID PLC", "SMITH (DS) RIGHTS NILL PAID PLC"),
  "WHITBREAD PLC" = c("WHITBREAD FULLY PAID RIGHTS PLC", "WHITBREAD NIL PAID RIGHTS PLC"),
  "KINNEVIK CLASS B" = c("KINNEVIK REDEMPTION SHARES CLASS B"),
  
  "ALCATEL LUCENT SA" = c("ALCATEL-LUCENT RIGHTS SA"),
  "BANCO COMERCIAL PORTUGUES SA" = c("BANCO COMERCIAL PORTUGUES RIGHTS S"),
  "BANCO POPOLARE" = c("BANCO POPOLARE RIGHTS"),
  "COMMERZBANK AG" = c("COMMERZBANK RIGHTS AG"),
  "DEUTSCHE BANK AG" = c("DEUTSCHE BANK RIGHTS AG"),
  "FIRSTGROUP PLC" = c("FIRSTGROUP RIGHTS PLC"),
  "INFORMA PLC" = c("INFORMA RIGHTS PLC"),
  "DEUTSCHE LUFTHANSA AG" = c("DEUTSCHE LUFTHANSA RIGHTS AG"),
  "PHOENIX GROUP HOLDINGS PLC" = c("PHOENIX GROUP HOLDINGS RIGHTS FULL"),
  "SERCO GROUP PLC" = c("SERCO GROUP RIGHTS PLC"),
  "STANDARD CHARTERED PLC" = c("STANDARD CHARTERED RIGHTS PLC"),
  "TRYG" = c("TRYG RIGHTS", "TRYG ORD", "TRYG A/S"),
  "DAIMLER TRUCK HOLDING E AG" = c("DAIMLER TRUCK INTERIM LINE"),
  "ZOOPLUS AG" = c("ZOOPLUS AG INTERIM LINE"),
  "BANCO SANTANDER SA" = c("BANCO SANTANDER RFD", "BANCO SANTANDER RIGHTS SA", "Banco Santander Rights",
                           "BANCO SA DER RIGHTS SA", "BANCO SANTANDER", "BANCO SANTAN DER RTS SA"),
  "SIEMENS ENERGY AG" = c("SIEMENS ENERGY N AG"),
  "CELLNEX TELECOM SA" = c("CELLNEX TELECOM RFD", "CELLNEX TELECOM RIGHTS SA",
                           "DERECHOS CELLNEX TELECOM S.A. SA",
                           "DERECHOS CELLNEX TELECOM S.A. RIG",
                           "DERECHOS CELLNEX TELECOM, S.A. RIG",
                           "CELLNEX TELECOM SAU"),
  "LOOMIS" = c("LOOMIS AB"),
  "KINNEVIK CLASS B" = c("KINNEVIK AB RED", "KINNEVIK REDEMPTION SHARES CLASS B",
                         "INVESTMENT KINNEVIK B REDEMPTION S",
                         "KINNEVIK REDEMPTION SHARES CLASS B"),
  "ALTICE EUROPE NV" = c("ALTICE CLASS A NV", "ALTICE CLASS B NV",
                         "ALTICE CLASS B NV WHEN ISSUED",
                         "ALTICE SA SA", "ALTICE EUROPE NV",
                         "ALTICE CLASS A NV WHEN ISSUED",
                         "ALTICE SA SA", "ALTICE CLASS B NV WHEN ISSUED",
                         "ALTICE SA SA"),
  "GETINGE B" = c("GETINGE AB"),
  "BANCO POPULAR ESPANOL SA" = c("BANCO POPULAR ESPANOL RIGHTS SA"),
  "BANCO DE SABADELL SA" = c("BANCO DE SABADELL", "BANCO DE SABADELL RIGHTS SA",
                             "BCO DE SABADELL", "BANCO DE SABADELL DER RIGHTS SA"),
  "REXAM PLC" = c("REXAM PLC B SHARES", "REXAM NON CUM RED PRF GBP (INTERI"),
  "AMEC FOSTER WHEELER PLC" = c("AMEC PLC"),
  "ABN AMRO BANK NV" = c("ABN AMRO GROUP DUTCH CERTIFICATES", "ABN AMRO GROUP GDR NV","ABN AMRO GROUP NV", "ABN AMRO BANK NV",
                 "ABN AMRO GROUP GDR NV", "ABN AMRO HOLDINGS"),
  "ARJO" = c("ARJO AB - B"),
  "WPP PLC" = c("WPP GROUP PLC"),
  "VONOVIA SE" = c("VONOVIA RIGHTS"),
  "VIFOR PHARMA AG" = c("VIFOR N . LINIE AG"),
  "VEOLIA ENVIRON. SA" = c("VEOLIA ENVIRON. RIGHTS SA"),
  "VANTAGE TOWERS V AG" = c("VANTAGE TOWERS N AG"),
  "VALEO" = c("VALEO SA"),
  "UNIPOL GRUPPO FINANZIARIO" = c("UNIPOL GRUPPO FINANZIARIO SPA PFD"),
  "UNIBAIL RODAMCO WE STAPLED UNITS" = c("UNIBAIL-RODAMCO SE", "UNIBAIL-RODAMCO SE REIT"),
  "TOTALENERGIES" = c("TOTAL", "TOTAL SA"),
  "SWEDISH ORPHAN BIOVITRUM" = c("SWEDISH ORPHAN BIOVITRUM PAID SUBS"),
  "SUEZ SA" = c("SUEZ", "GDF SUEZ SA"),
  "FIAT CHRYSLER AUTOMOBILES NV" = c("FIAT CHRYSLER AUTOMOBILES NV"),
  "EURONEXT NV" = c("EURONEXT N.V.", "EURONEXT RIGHTS NV"),
  "FERROVIAL SE" = c("FERROVIAL", "FERROVIAL SA"),
  "IBERDROLA SA" = c("IBERDROLA S.A.", "IBERDROLA RIGHTS SA",
                     "IBERDROLA RENOVABL EUR0.5","IBERDROLA DER RIGHTS SA", "IBEDROLA RIGHTS SA",
                     "DERECHOS DE IBERDROLA S.A. SA", "DERECHOS DE IBERDROLA SA", "DERECHOS DE IBERDROLA SA SA",
                     "DERECHOS DE IBERDROLA, S.A. SA", "DERECHOS IBERDROLA RTS SA", "IBEDROLA RIGHTS SA"),
  "INMOBILIARIA COLONIAL SA" = c("INMOB COLONIAL"),
  "INTU PROPERTIES REIT PLC" = c("INTU PROPERTIES FULL PAID RIGHTS P"),
  "KINNEVIK CLASS B" = c("KINNEVIK REDEMPTION SHARES CLASS B"),
  "JAZZTEL PLC" = c("JAZZTEL LTD"),
  "KINNEVIK CLASS B" = c("KINNEVIK AB RED"),
  "KONINKLIJKE KPN NV" = c("KONINKLIJKE KPN NV NV"),
  "LINDE PLC" = c("LINDE AG"),
  "LONMIN PLC" = c("LONMIN PLC RIGHTS"),
  "LOREAL SA" = c("L'OREAL SA"),
  "NATIONAL BANK OF GREECE SA" = c("NATIONAL BANK OF GREECE S.A.", "NATIONAL BANK OF GREECE RIGHTS SA",
                                   "NATIONAL BANK OF GREECE-CW17"),
  "NORDEA BANK" = c("NORDEA BANK ABP"),
  "OLD MUTUAL LIMITED LTD" = c("OLD MUTUAL LTD", "OLD MUTUAL PLC"),
  "PEUGEOT SA" = c("PEUGEOT RIGHTS SA"),
  "PHOENIX GROUP HOLDINGS PLC" = c("PHOENIX GROUP HOLDINGS", "PHOENIX GROUP HOLDINGS FP RIGHTS",
                                   "PHOENIX GROUP HOLDINGS NP RIGHTS", "PHOENIX GROUP HOLDINGS RIGHTS FULL"),
  "RELX PLC" = c("RELX NV NV", "REED ELSEVIER PLC", "REED ELSEVIER", "REED ELSEVIER NV"),
  "REPSOL SA" = c("REPSOL SA RIGHTS", "REPSOL SA RIGHTS SA"),
  "RHOEN-KLINIKUM AG" = c("RHOEN KLINIKUM AG"),
  "ROCHE HOLDING AG" = c("ROCHE HOLDING PAR AG"),
  "SAIPEM" = c("SAIPEM RIGHTS"),
  "SCHIBSTED CLASS A" = c("SCHIBSTED ASA", "SCHIBSTED ASA-B SHS","SCHIBSTED ASA-CL A", "SCHIBSTED B ORD",
                          "SCHIBSTED CLASS A", "SCHIBSTED ORD"),
  "SCOUT24 N" = c("SCOUT24 RIGHTS AG", "SCOUT24 N AG"),
  "SECURITAS B" = c("SECURITAS AB"),
  "SIEMENS N AG" = c("SIEMENS AG"),
  "STADA ARZNEIMITTEL AG" = c("STADA ARZNEIMITTEL V AG"),
  "STANDARD LIFE ABERDEEN PLC" = c("STANDARD LIFE PLC", "STANDARD LIFE ABERDEEN PLC"),
  "WPP PLC" = c("WPP GROUP PLC"),
  "ACS ACTIVIDADES DE CONSTRUCCION Y" = c("ACS ACTIVIDADES DE CONSTRUCCION Y"),
  "ANHEUSER-BUSCH INBEV SA" = c("ANHEUSER BUSCH INBEV SA"),
  "BABCOCK INTERNATIONAL GROUP PLC" = c("BABCOCK INTERNATIONAL GROUP RIGHTS")
  )


# Function to update consistent_name based on the mapping
update_consistent_name <- function(name, consistent_name, mapping) {
  for (key in names(mapping)) {
    if (name %in% mapping[[key]]) {
      return(key)
    }
  }
  return(consistent_name)
}

# Apply the function to update the consistent_name column
unique_names_data$consistent_name <- mapply(update_consistent_name, unique_names_data$name, unique_names_data$consistent_name, MoreArgs = list(mapping = name_mapping))



length(unique(unique_names_data$consistent_name)) #1403
length(unique(unique_names_data$name)) #1871
length(unique(unique_names_data$XXXX)) #1307

# Exporting the data frame to a CSV file
write.csv(unique_names_data, "cleaned_overview_euro_stoxx_600.csv")
###############################################################

unqiue_names_old <- unique_names_data


### consistent tickers
df <- df %>%
  arrange(consistent_name, desc(Datum)) %>% # Arrange by consistent name and date descending
  group_by(consistent_name) %>%
  mutate(consistent_ticker = first(Emittententicker)) %>% # Take the first ticker for each group, which will be the most recent one due to the arrangement
  ungroup() # Ungroup the data frame
